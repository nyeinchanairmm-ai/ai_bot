<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AMARA NYEIN - AI Chat Bot</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="{{ url_for('static', filename='script.js') }}"></script>
<!-- <img src="{{ url_for('static', filename='avatar.jpg') }}" alt="Avatar"> -->
<link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<style>
.chat-box::before {
    content: "";
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: url("{{ url_for('static', filename='avatar.jpg') }}") no-repeat center center;
    background-size: cover;
    opacity: 0.35;
    filter: blur(4px);
    z-index: -1;
}
</style>
<body>
    <!-- Top buttons -->
    <button class="top-btn" id="settingsBtn">Settings ‚öôÔ∏è</button>
    <button class="top-btn" id="darkModeBtn">üåô</button>

    <!-- Main container -->
    <div class="container">

        <!-- Header avatar and title -->
        <div class="header">
            <img src="{{ url_for('static', filename='avatar.jpg') }}" alt="Avatar">
            <h1>AMARA NYEIN (·Ä°·Äô·Äõ·Ä¨·ÄÑ·Äº·Ä≠·Äô·Ä∫·Ä∏)</h1>
            <p class="subtitle">AI Chat Bot</p>
        </div>

        <!-- Chatbox -->
        <div class="chat-box" id="chatBox"></div>

        <!-- Input form -->
        <form id="chatForm">
            <input type="text" id="userInput" placeholder="Type your message..." required>
            <button type="submit">Send</button>
        </form>

            <button id="clearChatBtn" class="top-btn">Clear Chat üóëÔ∏è</button>
    </div>

    <!-- Modal settings box -->
    <div class="modal" id="settingsModal">
        <span class="close" id="closeModal">&times;</span>
        <h2>AMARA NYEIN Chatbot</h2>
        <p>Version 1.0</p>
        <p>Created by AI GURU</p>
        <p>Power by Python</p>
    </div>

<!-- <script>
const chatBox = document.getElementById("chatBox");
const chatForm = document.getElementById("chatForm");
const userInput = document.getElementById("userInput");
// const clearBtn = document.getElementById("clearChatBtn");


// Load full message history from backend
async function loadHistory() {
    try {
        const res = await fetch("/api/messages");
        const messages = await res.json();
        chatBox.innerHTML = "";
        messages.forEach(m => addMessage(m.role, m.content));
    } catch (err) {
        console.error("Failed to load history:", err);
    }
}

// Show a message
function addMessage(role, content) {
    const msg = document.createElement("div");
    msg.className = `message ${role}`;
    msg.textContent = content;
    chatBox.appendChild(msg);
    chatBox.scrollTop = chatBox.scrollHeight;
}

// Submit message
chatForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const message = userInput.value.trim();
    if (!message) return;
    addMessage("user", message);
    userInput.value = "";
    try {
        const response = await fetch("/api/messages", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message })
        });
        if (response.ok) {
            const data = await response.json();
            addMessage("bot", data.content);
        } else {
            addMessage("bot", "‚ö†Ô∏è Error sending message.");
        }
    } catch (err) {
        addMessage("bot", "‚ö†Ô∏è Connection error.");
    }
});

// Dark mode toggle
const darkBtn = document.getElementById("darkModeBtn");
darkBtn.addEventListener("click", () => {
    document.body.classList.toggle("dark");
    darkBtn.textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è" : "üåô";
});

// Settings modal
const settingsBtn = document.getElementById("settingsBtn");
const modal = document.getElementById("settingsModal");
const closeModal = document.getElementById("closeModal");

settingsBtn.addEventListener("click", () => modal.style.display = "block");
closeModal.addEventListener("click", () => modal.style.display = "none");
window.addEventListener("click", (e) => { if(e.target === modal) modal.style.display = "none"; });

// Load history on page load
window.onload = loadHistory;

//Clear chat
const clearBtn = document.getElementById("clearChatBtn");

clearBtn.addEventListener("click", async () => {
    if(!confirm("Are you sure you want to clear the chat?")) return;
    try {
        const res = await fetch("/api/clear", { method:"POST" });
        if(res.ok){
            chatBox.innerHTML = "";
        } else {
            alert("Failed to clear chat.");
        }
    } catch(err){
        console.error(err);
        alert("Error clearing chat.");
    }
});

</script> -->
</body>
</html>
